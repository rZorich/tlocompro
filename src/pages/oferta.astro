---
import BaseLayout from "../layouts/BaseLayout.astro";

const FORMS_ENDPOINT = "https://script.google.com/macros/s/AKfycbyW5Ce0JKICwiHjLCN0QS-3d72cvvaHDr9ou6qBwPZM2Hm4pShuTz_0c7u1zH7cFRU5BQ/exec"; // tu URL real de Apps Script


const title = "Vende tu auto rápido en Chile | Tasación inmediata en 24 horas | Tlocompro";
const description = "Completa el formulario para recibir una oferta inmediata por tu vehículo usado. Pago al instante, firma en notaría y retiro en 24 horas en cualquier comuna de Chile.";
const canonical = "https://tlocompro.cl/oferta";
---
<BaseLayout {title} {description} {canonical}>

  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb" class="max-w-5xl mx-auto px-4 pt-6 text-sm text-gray-600">
    <a href="/" class="hover:text-teal-700">Inicio</a> / <span aria-current="page">Recibir oferta</span>
  </nav>

  <section class="max-w-5xl mx-auto px-4 py-8">
    <header class="mb-6">
      <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">✍️ Recibe tu oferta inmediata</h1>
      <p class="mt-2 text-gray-700">
        En <strong>Tlocompro</strong> compramos autos usados bajo el precio de mercado para ofrecerte
        <strong>liquidez inmediata</strong>: pago al instante, firma en notaría y <strong>retiro en 24 horas</strong>.
      </p>
      <h2 class="text-xl font-bold text-gray-900 mt-4">
        Tasación inmediata y compra directa de vehículos usados en todo Chile
      </h2>
      <p class="mt-2 text-gray-700">
        Si tu auto está en buen estado y con papeles al día, completa el formulario y te
        enviaremos una propuesta en menos de 24 horas hábiles.
      </p>
      <div class="mt-3 inline-flex items-center gap-2 text-xs font-semibold px-3 py-1 rounded-full bg-teal-100 text-teal-700 border border-teal-200">
        ⚡ Pago en el acto · Retiro en 24 h
      </div>
    </header>

    <form id="tlocomproForm" class="space-y-8" aria-labelledby="formTitulo" novalidate>


      <!-- Paso 1: Datos del vehículo -->
      <section class="bg-white border rounded-2xl shadow-card p-6">
        <h3 id="formTitulo" class="text-lg font-bold mb-4">1) Datos del vehículo</h3>

        <div class="grid md:grid-cols-4 gap-4">
          <div class="flex flex-col gap-1">
            <label for="marca" class="text-sm font-semibold text-gray-700">Marca</label>
            <input id="marca" name="marca" class="border rounded-xl p-3" type="text" placeholder="Ej: Toyota" required autocomplete="off" />
          </div>

          <div class="flex flex-col gap-1">
            <label for="modelo" class="text-sm font-semibold text-gray-700">Modelo</label>
            <input id="modelo" name="modelo" class="border rounded-xl p-3" type="text" placeholder="Ej: Yaris" required autocomplete="off" />
          </div>

          <div class="flex flex-col gap-1">
            <label for="anio" class="text-sm font-semibold text-gray-700">Año</label>
            <input id="anio" name="anio" class="border rounded-xl p-3" type="number" placeholder="Ej: 2018" min="1980" max="2026" required />
          </div>

          <div class="flex flex-col gap-1">
            <label for="version" class="text-sm font-semibold text-gray-700">Versión</label>
            <input id="version" name="version" class="border rounded-xl p-3" type="text" placeholder="Ej: XS, GLI" autocomplete="off" />
          </div>

          <div class="flex flex-col gap-1">
            <label for="transmision" class="text-sm font-semibold text-gray-700">Transmisión</label>
            <select id="transmision" name="transmision" class="border rounded-xl p-3">
              <option value="">Selecciona</option>
              <option>Manual</option>
              <option>Automática</option>
            </select>
          </div>

          <div class="flex flex-col gap-1">
            <label for="combustible" class="text-sm font-semibold text-gray-700">Combustible</label>
            <select id="combustible" name="combustible" class="border rounded-xl p-3">
              <option value="">Selecciona</option>
              <option>Bencina</option>
              <option>Diésel</option>
              <option>Híbrido</option>
              <option>Eléctrico</option>
            </select>
          </div>

          <div class="flex flex-col gap-1">
            <label for="kilometraje" class="text-sm font-semibold text-gray-700">Kilometraje (km)</label>
            <input id="kilometraje" name="kilometraje" class="border rounded-xl p-3" type="number" placeholder="Ej: 75000" min="0" required />
          </div>

          <div class="flex flex-col gap-1">
            <label for="patente" class="text-sm font-semibold text-gray-700">Patente</label>
            <input id="patente" name="patente" class="border rounded-xl p-3" type="text" placeholder="Ej: ABCD12" required autocomplete="off" />
          </div>
        </div>

        <div class="grid md:grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-1 md:col-span-2">
            <label for="observaciones" class="text-sm font-semibold text-gray-700">Observaciones</label>
            <textarea id="observaciones" name="observaciones" class="border rounded-xl p-3 w-full" rows="4" placeholder="Choques, mantenciones, estado de neumáticos, etc."></textarea>
          </div>
          <div class="flex flex-col gap-1">
            <label for="fotos_url" class="text-sm font-semibold text-gray-700">Fotos (enlace)</label>
            <input id="fotos_url" name="fotos_url" class="border rounded-xl p-3 w-full" type="url" placeholder="Link a Drive/Dropbox/Chileautos" />
          </div>
        </div>

        <div class="grid md:grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-1">
            <label for="duenio_unico" class="text-sm font-semibold text-gray-700">¿Dueño hace +30 días?</label>
            <select id="duenio_unico" name="duenio_unico" class="border rounded-xl p-3">
              <option value="">Selecciona</option>
              <option>Sí</option>
              <option>No</option>
            </select>
          </div>

          <div class="flex flex-col gap-1">
            <label for="papeles_al_dia" class="text-sm font-semibold text-gray-700">Papeles al día</label>
            <select id="papeles_al_dia" name="papeles_al_dia" class="border rounded-xl p-3" required>
              <option value="">Selecciona</option>
              <option>Sí</option>
              <option>No</option>
            </select>
          </div>

          <div class="flex flex-col gap-1">
            <label for="remate" class="text-sm font-semibold text-gray-700">¿Comprado en remate?</label>
            <select id="remate" name="remate" class="border rounded-xl p-3" required>
              <option value="">Selecciona</option>
              <option>Sí</option>
              <option>No</option>
            </select>
          </div>
        </div>
      </section>

      <!-- Paso 2: Tus datos -->
      <section class="bg-white border rounded-2xl shadow-card p-6">
        <h3 class="text-lg font-bold mb-4">2) Datos de contacto</h3>

        <div class="grid md:grid-cols-3 gap-4">
          <div class="flex flex-col gap-1">
            <label for="nombre" class="text-sm font-semibold text-gray-700">Nombre y apellido</label>
            <input id="nombre" name="nombre" class="border rounded-xl p-3" type="text" placeholder="Ej: Juan Pérez" required autocomplete="name" />
          </div>

          <div class="flex flex-col gap-1">
            <label for="whatsapp" class="text-sm font-semibold text-gray-700">WhatsApp</label>
            <input id="whatsapp" name="whatsapp" class="border rounded-xl p-3" type="tel" placeholder="+56 9 ..." required autocomplete="tel" />
          </div>

          <div class="flex flex-col gap-1">
            <label for="email" class="text-sm font-semibold text-gray-700">Email</label>
            <input id="email" name="email" class="border rounded-xl p-3" type="email" placeholder="tu@correo.cl" required autocomplete="email" />
          </div>
        </div>

        <div class="grid md:grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-1">
            <label for="rut" class="text-sm font-semibold text-gray-700">RUT (opcional)</label>
            <input id="rut" name="rut" class="border rounded-xl p-3" type="text" placeholder="11.111.111-1" autocomplete="off" />
          </div>

          <div class="flex flex-col gap-1">
            <label for="preferencia_contacto" class="text-sm font-semibold text-gray-700">Preferencia de contacto</label>
            <select id="preferencia_contacto" name="preferencia_contacto" class="border rounded-xl p-3">
              <option value="">Selecciona</option>
              <option>WhatsApp</option>
              <option>Llamada</option>
              <option>Email</option>
            </select>
          </div>

          <div class="flex flex-col gap-1">
            <label for="ciudad" class="text-sm font-semibold text-gray-700">Ciudad</label>
            <input id="ciudad" name="ciudad" class="border rounded-xl p-3" type="text" placeholder="Ej: Santiago" required autocomplete="address-level2" />
          </div>
        </div>

        <div class="grid md:grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-1">
            <label for="cuando_vender" class="text-sm font-semibold text-gray-700">¿Cuándo necesitas vender?</label>
            <select id="cuando_vender" name="cuando_vender" class="border rounded-xl p-3">
              <option value="">Selecciona</option>
              <option>Hoy</option>
              <option>1-3 días</option>
              <option>Esta semana</option>
              <option>Solo cotizando</option>
            </select>
          </div>
        </div>

        <div class="mt-4 text-xs text-gray-600 bg-gray-50 border rounded-xl p-3">
          <strong>Privacidad:</strong> Usaremos tus datos solo para evaluar la oferta y contactarte. Transferencia bancaria en notaría.
        </div>
      </section>

      <!-- Aceptación y envío -->
      <div class="flex items-center justify-between">
        <label class="inline-flex items-center gap-2 text-sm">
          <input type="checkbox" name="acepta_condiciones" required class="accent-teal-600" />
          Acepto que la oferta será <strong>más baja que el precio de mercado</strong> a cambio de liquidez inmediata.
        </label>

        <button class="bg-teal-600 hover:bg-teal-700 text-white font-semibold px-6 py-3 rounded-xl shadow-soft">
          💸 Enviar y recibir oferta
        </button>
      </div>
    </form>

    <div class="mt-6 text-sm text-gray-600">
      ¿Dudas? Revisa nuestras <a href="/preguntas-frecuentes" class="text-teal-700 font-semibold hover:underline">Preguntas frecuentes</a>.
    </div>
  </section>

  <!-- Schema.org para esta página -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Service",
    "serviceType": "Compra de autos usados",
    "provider": {
      "@type": "Organization",
      "name": "Tlocompro",
      "url": "https://tlocompro.cl",
      "logo": "https://tlocompro.cl/logo-tlocompro.png"
    },
    "areaServed": {
      "@type": "Country",
      "name": "Chile"
    },
    "description": "Servicio de compra inmediata de autos usados en Chile. Pago al contado, firma en notaría y retiro en 24 horas.",
    "offers": {
      "@type": "Offer",
      "priceCurrency": "CLP",
      "availability": "https://schema.org/InStock",
      "url": "https://tlocompro.cl/oferta"
    }
  }
  </script>
  <script>
    window.addEventListener("load", function () {
      const form = document.getElementById("tlocomproForm");
      if (!(form instanceof HTMLFormElement)) return;


      form.addEventListener("submit", async function (event) {
        event.preventDefault();
        const data = Object.fromEntries(new FormData(form).entries());

        try {
          const res = await fetch("https://script.google.com/macros/s/AKfycbyW5Ce0JKICwiHjLCN0QS-3d72cvvaHDr9ou6qBwPZM2Hm4pShuTz_0c7u1zH7cFRU5BQ/exec", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
          });

          if (res.ok) {
            window.location.href = "/gracias";
          } else {
            alert("Hubo un error al enviar el formulario.");
          }
        } catch (err) {
          alert("No se pudo conectar al servidor.");
          console.error(err);
        }
      });
    });
  </script>


</BaseLayout>


